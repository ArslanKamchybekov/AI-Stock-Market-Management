{"version":3,"file":"ReactEighteenAdapter.js","names":["FiberTags","nodeAndSiblingsArray","nodeWithSibling","array","node","push","sibling","flatten","arr","result","stack","i","length","n","pop","el","Array","isArray","nodeTypeFromType","type","Portal","utilNodeTypeFromType","isMemo","compareNodeTypeOf","Memo","isLazy","Lazy","unmemoType","transformSuspense","renderedEl","prerenderEl","suspenseFallback","isSuspense","children","props","fallback","replaceLazyWithFallback","propTypes","defaultProps","contextTypes","contextType","childContextTypes","FakeSuspense","isStateful","React","createElement","elementToTree","isPortal","utilElementToTree","containerInfo","nodeType","key","ensureKeyOrUndefined","ref","instance","rendered","toTree","vnode","findCurrentFiberUsingSlowPath","tag","HostRoot","childrenToTree","child","HostPortal","stateNode","memoizedProps","ClassComponent","FunctionalComponent","MemoClass","elementType","MemoSFC","renderedNodes","map","HostComponent","HostText","Fragment","Mode","ContextProvider","ContextConsumer","Profiler","ForwardRef","pendingProps","Suspense","OffscreenComponent","console","log","nodeToHostNode","Error","_node","mapper","item","ReactDOM","findDOMNode","eventOptions","animation","pointerEvents","auxClick","wrapAct","fn","returnVal","TestUtils","act","getProviderDefaultValue","Provider","_context","_defaultValue","_currentValue","makeFakeElement","$$typeof","Element","Component","prototype","isReactComponent","__reactAutoBindPairs","ReactEighteenAdapter","lifecycles","options","enableComponentDidUpdateOnSetState","legacyContextMode","componentDidUpdate","onSetState","getDerivedStateFromProps","hasShouldComponentUpdateBug","getSnapshotBeforeUpdate","setState","skipsComponentDidUpdateOnNullish","getChildContext","calledByRenderer","getDerivedStateFromError","assertDomAvailable","has","TypeError","detectFiberTags","attachTo","hydrateIn","wrappingComponentProps","domNode","global","document","adapter","render","context","callback","wrapperProps","refProp","ReactWrapperComponent","createMountWrapper","wrappedEl","hydrate","setChildProps","unmount","unmountComponentAtNode","getNode","getNodeFromRootFinder","isCustomComponent","_reactInternals","simulateError","nodeHierarchy","rootNode","error","isErrorBoundary","elInstance","componentDidCatch","find","catchingInstance","catchingType","displayNameOfNode","simulateEvent","event","mock","mappedEvent","mapNativeEventNames","eventFn","Simulate","batchedUpdates","getWrappingComponentRenderer","getWrappingComponentMountRenderer","inst","getMountWrapperInstance","wrapInvoke","renderer","ShallowRenderer","isDOM","cachedNode","lastComponent","wrappedComponent","sentinel","wrapPureComponent","compare","shouldComponentUpdate","nextProps","isPureReactComponent","memoized","prevProps","shouldUpdate","shallowEqual","args","displayName","renderElement","elConfig","rest","clonedEl","elementIsChanged","unmaskedContext","providerValues","Map","isContextProvider","set","value","MockProvider","withSetStateAllowed","isContextConsumer","getProviderFromConsumer","get","MockConsumer","getMaskedContext","InnerComp","output","getRenderOutput","_instance","concat","handler","propFromEvent","checkPropTypes","typeSpecs","values","location","hierarchy","getComponentStack","ContextWrapper","createRenderWrapper","ReactDOMServer","renderToStaticMarkup","mode","EnzymeAdapter","MODES","MOUNT","createMountRenderer","SHALLOW","createShallowRenderer","STRING","createStringRenderer","element","wrap","propsWithKeysAndRef","matchingType","supportsArray","nodes","ConcurrentMode","NaN","StrictMode","$$typeofType","nodeName","name","isElement","object","isValidElementType","fragment","typeOfNode","fakeElement","isForwardRef","isValidElement","Consumer","RootFinder","wrapWithWrappingComponent","module","exports"],"sources":["../src/ReactEighteenAdapter.js"],"sourcesContent":["/* eslint no-use-before-define: 0 */\r\nimport React from 'react';\r\nimport ReactDOM from 'react-dom';\r\n// eslint-disable-next-line import/no-unresolved\r\nimport ReactDOMServer from 'react-dom/server';\r\n// eslint-disable-next-line import/no-unresolved\r\nimport ShallowRenderer from 'react-test-renderer/shallow';\r\n// eslint-disable-next-line import/no-unresolved\r\nimport TestUtils from 'react-dom/test-utils';\r\nimport checkPropTypes from 'prop-types/checkPropTypes';\r\nimport has from 'has';\r\nimport {\r\n  ConcurrentMode,\r\n  ContextConsumer,\r\n  ContextProvider,\r\n  Element,\r\n  ForwardRef,\r\n  Fragment,\r\n  isContextConsumer,\r\n  isContextProvider,\r\n  isElement,\r\n  isForwardRef,\r\n  isPortal,\r\n  isSuspense,\r\n  isValidElementType,\r\n  Lazy,\r\n  Memo,\r\n  Portal,\r\n  Profiler,\r\n  StrictMode,\r\n  Suspense,\r\n} from 'react-is';\r\nimport { EnzymeAdapter } from 'enzyme';\r\nimport { typeOfNode } from 'enzyme/build/Utils';\r\nimport shallowEqual from 'enzyme-shallow-equal';\r\nimport {\r\n  displayNameOfNode,\r\n  elementToTree as utilElementToTree,\r\n  nodeTypeFromType as utilNodeTypeFromType,\r\n  mapNativeEventNames,\r\n  propFromEvent,\r\n  assertDomAvailable,\r\n  withSetStateAllowed,\r\n  createRenderWrapper,\r\n  createMountWrapper,\r\n  propsWithKeysAndRef,\r\n  ensureKeyOrUndefined,\r\n  simulateError,\r\n  wrap,\r\n  getMaskedContext,\r\n  getComponentStack,\r\n  RootFinder,\r\n  getNodeFromRootFinder,\r\n  wrapWithWrappingComponent,\r\n  getWrappingComponentMountRenderer,\r\n  compareNodeTypeOf,\r\n} from 'enzyme-adapter-utils';\r\nimport findCurrentFiberUsingSlowPath from './findCurrentFiberUsingSlowPath';\r\nimport detectFiberTags from './detectFiberTags';\r\n\r\n// Lazily populated if DOM is available.\r\nlet FiberTags = null;\r\n\r\nfunction nodeAndSiblingsArray(nodeWithSibling) {\r\n  const array = [];\r\n  let node = nodeWithSibling;\r\n  while (node != null) {\r\n    array.push(node);\r\n    node = node.sibling;\r\n  }\r\n  return array;\r\n}\r\n\r\nfunction flatten(arr) {\r\n  const result = [];\r\n  const stack = [{ i: 0, array: arr }];\r\n  while (stack.length) {\r\n    const n = stack.pop();\r\n    while (n.i < n.array.length) {\r\n      const el = n.array[n.i];\r\n      n.i += 1;\r\n      if (Array.isArray(el)) {\r\n        stack.push(n);\r\n        stack.push({ i: 0, array: el });\r\n        break;\r\n      }\r\n      result.push(el);\r\n    }\r\n  }\r\n  return result;\r\n}\r\n\r\nfunction nodeTypeFromType(type) {\r\n  if (type === Portal) {\r\n    return 'portal';\r\n  }\r\n\r\n  return utilNodeTypeFromType(type);\r\n}\r\n\r\nfunction isMemo(type) {\r\n  return compareNodeTypeOf(type, Memo);\r\n}\r\n\r\nfunction isLazy(type) {\r\n  return compareNodeTypeOf(type, Lazy);\r\n}\r\n\r\nfunction unmemoType(type) {\r\n  return isMemo(type) ? type.type : type;\r\n}\r\n\r\nfunction transformSuspense(renderedEl, prerenderEl, { suspenseFallback }) {\r\n  if (!isSuspense(renderedEl)) {\r\n    return renderedEl;\r\n  }\r\n\r\n  let { children } = renderedEl.props;\r\n\r\n  if (suspenseFallback) {\r\n    const { fallback } = renderedEl.props;\r\n    children = replaceLazyWithFallback(children, fallback);\r\n  }\r\n\r\n  const {\r\n    propTypes,\r\n    defaultProps,\r\n    contextTypes,\r\n    contextType,\r\n    childContextTypes,\r\n  } = renderedEl.type;\r\n\r\n  const FakeSuspense = Object.assign(\r\n    isStateful(prerenderEl.type)\r\n      ? class FakeSuspense extends prerenderEl.type {\r\n        render() {\r\n          const { type, props } = prerenderEl;\r\n          return React.createElement(\r\n            type,\r\n            { ...props, ...this.props },\r\n            children,\r\n          );\r\n        }\r\n      }\r\n      : function FakeSuspense(props) { // eslint-disable-line prefer-arrow-callback\r\n        return React.createElement(\r\n          renderedEl.type,\r\n          { ...renderedEl.props, ...props },\r\n          children,\r\n        );\r\n      },\r\n    {\r\n      propTypes,\r\n      defaultProps,\r\n      contextTypes,\r\n      contextType,\r\n      childContextTypes,\r\n    },\r\n  );\r\n  return React.createElement(FakeSuspense, null, children);\r\n}\r\n\r\nfunction elementToTree(el) {\r\n  if (!isPortal(el)) {\r\n    return utilElementToTree(el, elementToTree);\r\n  }\r\n\r\n  const { children, containerInfo } = el;\r\n  const props = { children, containerInfo };\r\n\r\n  return {\r\n    nodeType: 'portal',\r\n    type: Portal,\r\n    props,\r\n    key: ensureKeyOrUndefined(el.key),\r\n    ref: el.ref || null,\r\n    instance: null,\r\n    rendered: elementToTree(el.children),\r\n  };\r\n}\r\n\r\nfunction toTree(vnode) {\r\n  if (vnode == null) {\r\n    return null;\r\n  }\r\n  // TODO(lmr): I'm not really sure I understand whether or not this is what\r\n  // i should be doing, or if this is a hack for something i'm doing wrong\r\n  // somewhere else. Should talk to sebastian about this perhaps\r\n  const node = findCurrentFiberUsingSlowPath(vnode);\r\n  switch (node.tag) {\r\n    case FiberTags.HostRoot:\r\n      return childrenToTree(node.child);\r\n    case FiberTags.HostPortal: {\r\n      const {\r\n        stateNode: { containerInfo },\r\n        memoizedProps: children,\r\n      } = node;\r\n      const props = { containerInfo, children };\r\n      return {\r\n        nodeType: 'portal',\r\n        type: Portal,\r\n        props,\r\n        key: ensureKeyOrUndefined(node.key),\r\n        ref: node.ref,\r\n        instance: null,\r\n        rendered: childrenToTree(node.child),\r\n      };\r\n    }\r\n    case FiberTags.ClassComponent:\r\n      return {\r\n        nodeType: 'class',\r\n        type: node.type,\r\n        props: { ...node.memoizedProps },\r\n        key: ensureKeyOrUndefined(node.key),\r\n        ref: node.ref,\r\n        instance: node.stateNode,\r\n        rendered: childrenToTree(node.child),\r\n      };\r\n    case FiberTags.FunctionalComponent:\r\n      return {\r\n        nodeType: 'function',\r\n        type: node.type,\r\n        props: { ...node.memoizedProps },\r\n        key: ensureKeyOrUndefined(node.key),\r\n        ref: node.ref,\r\n        instance: null,\r\n        rendered: childrenToTree(node.child),\r\n      };\r\n    case FiberTags.MemoClass:\r\n      return {\r\n        nodeType: 'class',\r\n        type: node.elementType.type,\r\n        props: { ...node.memoizedProps },\r\n        key: ensureKeyOrUndefined(node.key),\r\n        ref: node.ref,\r\n        instance: node.stateNode,\r\n        rendered: childrenToTree(node.child.child),\r\n      };\r\n    case FiberTags.MemoSFC: {\r\n      let renderedNodes = flatten(nodeAndSiblingsArray(node.child).map(toTree));\r\n      if (renderedNodes.length === 0) {\r\n        renderedNodes = [node.memoizedProps.children];\r\n      }\r\n      return {\r\n        nodeType: 'function',\r\n        type: node.elementType,\r\n        props: { ...node.memoizedProps },\r\n        key: ensureKeyOrUndefined(node.key),\r\n        ref: node.ref,\r\n        instance: null,\r\n        rendered: renderedNodes,\r\n      };\r\n    }\r\n    case FiberTags.HostComponent: {\r\n      let renderedNodes = flatten(nodeAndSiblingsArray(node.child).map(toTree));\r\n      if (renderedNodes.length === 0) {\r\n        renderedNodes = [node.memoizedProps.children];\r\n      }\r\n      return {\r\n        nodeType: 'host',\r\n        type: node.type,\r\n        props: { ...node.memoizedProps },\r\n        key: ensureKeyOrUndefined(node.key),\r\n        ref: node.ref,\r\n        instance: node.stateNode,\r\n        rendered: renderedNodes,\r\n      };\r\n    }\r\n    case FiberTags.HostText:\r\n      return node.memoizedProps;\r\n    case FiberTags.Fragment:\r\n    case FiberTags.Mode:\r\n    case FiberTags.ContextProvider:\r\n    case FiberTags.ContextConsumer:\r\n      return childrenToTree(node.child);\r\n    case FiberTags.Profiler:\r\n    case FiberTags.ForwardRef: {\r\n      return {\r\n        nodeType: 'function',\r\n        type: node.type,\r\n        props: { ...node.pendingProps },\r\n        key: ensureKeyOrUndefined(node.key),\r\n        ref: node.ref,\r\n        instance: null,\r\n        rendered: childrenToTree(node.child),\r\n      };\r\n    }\r\n    case FiberTags.Suspense: {\r\n      return {\r\n        nodeType: 'function',\r\n        type: Suspense,\r\n        props: { ...node.memoizedProps },\r\n        key: ensureKeyOrUndefined(node.key),\r\n        ref: node.ref,\r\n        instance: null,\r\n        rendered: childrenToTree(node.child),\r\n      };\r\n    }\r\n    case FiberTags.Lazy:\r\n      return childrenToTree(node.child);\r\n    case FiberTags.OffscreenComponent: {\r\n      console.log(node.return.memoizedProps.children);\r\n      return {\r\n        nodeType: 'function',\r\n        type: Suspense,\r\n        props: { ...node.memoizedProps },\r\n        key: ensureKeyOrUndefined(node.key),\r\n        ref: node.ref,\r\n        instance: null,\r\n        rendered: childrenToTree(nodeToHostNode(node.return.memoizedProps.children)),\r\n      };\r\n    }\r\n    default:\r\n      throw new Error(`Enzyme Internal Error: unknown node with tag ${node.tag}`);\r\n  }\r\n}\r\n\r\nfunction childrenToTree(node) {\r\n  if (!node) {\r\n    return null;\r\n  }\r\n  const children = nodeAndSiblingsArray(node);\r\n  if (children.length === 0) {\r\n    return null;\r\n  }\r\n  if (children.length === 1) {\r\n    return toTree(children[0]);\r\n  }\r\n  return flatten(children.map(toTree));\r\n}\r\n\r\nfunction nodeToHostNode(_node) {\r\n  // NOTE(lmr): node could be a function component\r\n  // which wont have an instance prop, but we can get the\r\n  // host node associated with its return value at that point.\r\n  // Although this breaks down if the return value is an array,\r\n  // as is possible with React 16.\r\n  let node = _node;\r\n  while (node && !Array.isArray(node) && node.instance === null) {\r\n    node = node.rendered;\r\n  }\r\n  // if the SFC returned null effectively, there is no host node.\r\n  if (!node) {\r\n    return null;\r\n  }\r\n\r\n  const mapper = (item) => {\r\n    if (item && item.instance) return ReactDOM.findDOMNode(item.instance);\r\n    return null;\r\n  };\r\n  if (Array.isArray(node)) {\r\n    return node.map(mapper);\r\n  }\r\n  if (Array.isArray(node.rendered) && node.nodeType === 'class') {\r\n    return node.rendered.map(mapper);\r\n  }\r\n  return mapper(node);\r\n}\r\n\r\nfunction replaceLazyWithFallback(node, fallback) {\r\n  if (!node) {\r\n    return null;\r\n  }\r\n  if (Array.isArray(node)) {\r\n    return node.map((el) => replaceLazyWithFallback(el, fallback));\r\n  }\r\n  if (isLazy(node.type)) {\r\n    return fallback;\r\n  }\r\n  return {\r\n    ...node,\r\n    props: {\r\n      ...node.props,\r\n      children: replaceLazyWithFallback(node.props.children, fallback),\r\n    },\r\n  };\r\n}\r\n\r\nconst eventOptions = {\r\n  animation: true,\r\n  pointerEvents: true,\r\n  auxClick: true,\r\n};\r\n\r\nfunction wrapAct(fn) {\r\n  let returnVal;\r\n  TestUtils.act(() => { returnVal = fn(); });\r\n  return returnVal;\r\n}\r\n\r\nfunction getProviderDefaultValue(Provider) {\r\n  // React stores references to the Provider's defaultValue differently across versions.\r\n  if ('_defaultValue' in Provider._context) {\r\n    return Provider._context._defaultValue;\r\n  }\r\n  if ('_currentValue' in Provider._context) {\r\n    return Provider._context._currentValue;\r\n  }\r\n  throw new Error('Enzyme Internal Error: can’t figure out how to get Provider’s default value');\r\n}\r\n\r\nfunction makeFakeElement(type) {\r\n  return { $$typeof: Element, type };\r\n}\r\n\r\nfunction isStateful(Component) {\r\n  return Component.prototype && (\r\n    Component.prototype.isReactComponent\r\n    || Array.isArray(Component.__reactAutoBindPairs) // fallback for createClass components\r\n  );\r\n}\r\n\r\nclass ReactEighteenAdapter extends EnzymeAdapter {\r\n  constructor() {\r\n    super();\r\n    const { lifecycles } = this.options;\r\n    this.options = {\r\n      ...this.options,\r\n      enableComponentDidUpdateOnSetState: true, // TODO: remove, semver-major\r\n      legacyContextMode: 'parent',\r\n      lifecycles: {\r\n        ...lifecycles,\r\n        componentDidUpdate: {\r\n          onSetState: true,\r\n        },\r\n        getDerivedStateFromProps: {\r\n          hasShouldComponentUpdateBug: false,\r\n        },\r\n        getSnapshotBeforeUpdate: true,\r\n        setState: {\r\n          skipsComponentDidUpdateOnNullish: true,\r\n        },\r\n        getChildContext: {\r\n          calledByRenderer: false,\r\n        },\r\n        getDerivedStateFromError: true,\r\n      },\r\n    };\r\n  }\r\n\r\n  createMountRenderer(options) {\r\n    assertDomAvailable('mount');\r\n    if (has(options, 'suspenseFallback')) {\r\n      throw new TypeError('`suspenseFallback` is not supported by the `mount` renderer');\r\n    }\r\n    if (FiberTags === null) {\r\n      // Requires DOM.\r\n      FiberTags = detectFiberTags();\r\n    }\r\n    const { attachTo, hydrateIn, wrappingComponentProps } = options;\r\n    const domNode = hydrateIn || attachTo || global.document.createElement('div');\r\n    let instance = null;\r\n    const adapter = this;\r\n    return {\r\n      render(el, context, callback) {\r\n        return wrapAct(() => {\r\n          if (instance === null) {\r\n            const { type, props, ref } = el;\r\n            const wrapperProps = {\r\n              Component: type,\r\n              props,\r\n              wrappingComponentProps,\r\n              context,\r\n              ...(ref && { refProp: ref }),\r\n            };\r\n            const ReactWrapperComponent = createMountWrapper(el, { ...options, adapter });\r\n            const wrappedEl = React.createElement(ReactWrapperComponent, wrapperProps);\r\n            instance = hydrateIn\r\n              ? ReactDOM.hydrate(wrappedEl, domNode)\r\n              : ReactDOM.render(wrappedEl, domNode);\r\n            if (typeof callback === 'function') {\r\n              callback();\r\n            }\r\n          } else {\r\n            instance.setChildProps(el.props, context, callback);\r\n          }\r\n        });\r\n      },\r\n      unmount() {\r\n        ReactDOM.unmountComponentAtNode(domNode);\r\n        instance = null;\r\n      },\r\n      getNode() {\r\n        if (!instance) {\r\n          return null;\r\n        }\r\n        return getNodeFromRootFinder(\r\n          adapter.isCustomComponent,\r\n          toTree(instance._reactInternals),\r\n          options,\r\n        );\r\n      },\r\n      simulateError(nodeHierarchy, rootNode, error) {\r\n        const isErrorBoundary = ({ instance: elInstance, type }) => {\r\n          if (type && type.getDerivedStateFromError) {\r\n            return true;\r\n          }\r\n          return elInstance && elInstance.componentDidCatch;\r\n        };\r\n\r\n        const {\r\n          instance: catchingInstance,\r\n          type: catchingType,\r\n        } = nodeHierarchy.find(isErrorBoundary) || {};\r\n\r\n        simulateError(\r\n          error,\r\n          catchingInstance,\r\n          rootNode,\r\n          nodeHierarchy,\r\n          nodeTypeFromType,\r\n          adapter.displayNameOfNode,\r\n          catchingType,\r\n        );\r\n      },\r\n      simulateEvent(node, event, mock) {\r\n        const mappedEvent = mapNativeEventNames(event, eventOptions);\r\n        const eventFn = TestUtils.Simulate[mappedEvent];\r\n        if (!eventFn) {\r\n          throw new TypeError(`ReactWrapper::simulate() event '${event}' does not exist`);\r\n        }\r\n        wrapAct(() => {\r\n          eventFn(adapter.nodeToHostNode(node), mock);\r\n        });\r\n      },\r\n      batchedUpdates(fn) {\r\n        return fn();\r\n        // return ReactDOM.unstable_batchedUpdates(fn);\r\n      },\r\n      getWrappingComponentRenderer() {\r\n        return {\r\n          ...this,\r\n          ...getWrappingComponentMountRenderer({\r\n            toTree: (inst) => toTree(inst._reactInternals),\r\n            getMountWrapperInstance: () => instance,\r\n          }),\r\n        };\r\n      },\r\n      wrapInvoke: wrapAct,\r\n    };\r\n  }\r\n\r\n  createShallowRenderer(options = {}) {\r\n    const adapter = this;\r\n    const renderer = new ShallowRenderer();\r\n    const { suspenseFallback } = options;\r\n    if (typeof suspenseFallback !== 'undefined' && typeof suspenseFallback !== 'boolean') {\r\n      throw TypeError('`options.suspenseFallback` should be boolean or undefined');\r\n    }\r\n    let isDOM = false;\r\n    let cachedNode = null;\r\n\r\n    let lastComponent = null;\r\n    let wrappedComponent = null;\r\n    const sentinel = {};\r\n\r\n    // wrap memo components with a PureComponent, or a class component with sCU\r\n    const wrapPureComponent = (Component, compare) => {\r\n      if (lastComponent !== Component) {\r\n        if (isStateful(Component)) {\r\n          wrappedComponent = class extends Component {}; // eslint-disable-line react/prefer-stateless-function\r\n          if (compare) {\r\n            wrappedComponent.prototype.shouldComponentUpdate = (nextProps) => !compare(this.props, nextProps);\r\n          } else {\r\n            wrappedComponent.prototype.isPureReactComponent = true;\r\n          }\r\n        } else {\r\n          let memoized = sentinel;\r\n          let prevProps;\r\n          wrappedComponent = function (props, ...args) {\r\n            const shouldUpdate = memoized === sentinel || (compare\r\n              ? !compare(prevProps, props)\r\n              : !shallowEqual(prevProps, props)\r\n            );\r\n            if (shouldUpdate) {\r\n              memoized = Component({ ...Component.defaultProps, ...props }, ...args);\r\n              prevProps = props;\r\n            }\r\n            return memoized;\r\n          };\r\n        }\r\n        Object.assign(\r\n          wrappedComponent,\r\n          Component,\r\n          { displayName: adapter.displayNameOfNode({ type: Component }) },\r\n        );\r\n        lastComponent = Component;\r\n      }\r\n      return wrappedComponent;\r\n    };\r\n\r\n    const renderElement = (elConfig, ...rest) => {\r\n      const renderedEl = renderer.render(elConfig, ...rest);\r\n\r\n      if (renderedEl && renderedEl.type) {\r\n        const clonedEl = transformSuspense(renderedEl, elConfig, { suspenseFallback });\r\n\r\n        const elementIsChanged = clonedEl.type !== renderedEl.type;\r\n        if (elementIsChanged) {\r\n          return renderer.render({ ...elConfig, type: clonedEl.type }, ...rest);\r\n        }\r\n      }\r\n\r\n      return renderedEl;\r\n    };\r\n\r\n    return {\r\n      render(el, unmaskedContext, {\r\n        providerValues = new Map(),\r\n      } = {}) {\r\n        cachedNode = el;\r\n        /* eslint consistent-return: 0 */\r\n        if (typeof el.type === 'string') {\r\n          isDOM = true;\r\n        } else if (isContextProvider(el)) {\r\n          providerValues.set(el.type, el.props.value);\r\n          const MockProvider = Object.assign(\r\n            (props) => props.children,\r\n            el.type,\r\n          );\r\n          return withSetStateAllowed(() => renderElement({ ...el, type: MockProvider }));\r\n        } else if (isContextConsumer(el)) {\r\n          const Provider = adapter.getProviderFromConsumer(el.type);\r\n          const value = providerValues.has(Provider)\r\n            ? providerValues.get(Provider)\r\n            : getProviderDefaultValue(Provider);\r\n          const MockConsumer = Object.assign(\r\n            (props) => props.children(value),\r\n            el.type,\r\n          );\r\n          return withSetStateAllowed(() => renderElement({ ...el, type: MockConsumer }));\r\n        } else {\r\n          isDOM = false;\r\n          let renderedEl = el;\r\n          if (isLazy(renderedEl)) {\r\n            throw TypeError('`React.lazy` is not supported by shallow rendering.');\r\n          }\r\n\r\n          renderedEl = transformSuspense(renderedEl, renderedEl, { suspenseFallback });\r\n          const { type: Component } = renderedEl;\r\n\r\n          const context = getMaskedContext(Component.contextTypes, unmaskedContext);\r\n\r\n          if (isMemo(el.type)) {\r\n            const { type: InnerComp, compare } = el.type;\r\n\r\n            return withSetStateAllowed(() => renderElement(\r\n              { ...el, type: wrapPureComponent(InnerComp, compare) },\r\n              context,\r\n            ));\r\n          }\r\n\r\n          if (!isStateful(Component) && typeof Component === 'function') {\r\n            return withSetStateAllowed(() => renderElement(\r\n              { ...renderedEl, type: Component },\r\n              context,\r\n            ));\r\n          }\r\n\r\n          return withSetStateAllowed(() => renderElement(renderedEl, context));\r\n        }\r\n      },\r\n      unmount() {\r\n        renderer.unmount();\r\n      },\r\n      getNode() {\r\n        if (isDOM) {\r\n          return elementToTree(cachedNode);\r\n        }\r\n        const output = renderer.getRenderOutput();\r\n        return {\r\n          nodeType: nodeTypeFromType(cachedNode.type),\r\n          type: cachedNode.type,\r\n          props: cachedNode.props,\r\n          key: ensureKeyOrUndefined(cachedNode.key),\r\n          ref: cachedNode.ref,\r\n          instance: renderer._instance,\r\n          rendered: Array.isArray(output)\r\n            ? flatten(output).map((el) => elementToTree(el))\r\n            : elementToTree(output),\r\n        };\r\n      },\r\n      simulateError(nodeHierarchy, rootNode, error) {\r\n        simulateError(\r\n          error,\r\n          renderer._instance,\r\n          cachedNode,\r\n          nodeHierarchy.concat(cachedNode),\r\n          nodeTypeFromType,\r\n          adapter.displayNameOfNode,\r\n          cachedNode.type,\r\n        );\r\n      },\r\n      simulateEvent(node, event, ...args) {\r\n        const handler = node.props[propFromEvent(event, eventOptions)];\r\n        if (handler) {\r\n          withSetStateAllowed(() => {\r\n            // TODO(lmr): create/use synthetic events\r\n            // TODO(lmr): emulate React's event propagation\r\n            // ReactDOM.unstable_batchedUpdates(() => {\r\n            handler(...args);\r\n            // });\r\n          });\r\n        }\r\n      },\r\n      batchedUpdates(fn) {\r\n        return fn();\r\n        // return ReactDOM.unstable_batchedUpdates(fn);\r\n      },\r\n      checkPropTypes(typeSpecs, values, location, hierarchy) {\r\n        return checkPropTypes(\r\n          typeSpecs,\r\n          values,\r\n          location,\r\n          displayNameOfNode(cachedNode),\r\n          () => getComponentStack(hierarchy.concat([cachedNode])),\r\n        );\r\n      },\r\n    };\r\n  }\r\n\r\n  createStringRenderer(options) {\r\n    if (has(options, 'suspenseFallback')) {\r\n      throw new TypeError('`suspenseFallback` should not be specified in options of string renderer');\r\n    }\r\n    return {\r\n      render(el, context) {\r\n        if (options.context && (el.type.contextTypes || options.childContextTypes)) {\r\n          const childContextTypes = {\r\n            ...(el.type.contextTypes || {}),\r\n            ...options.childContextTypes,\r\n          };\r\n          const ContextWrapper = createRenderWrapper(el, context, childContextTypes);\r\n          return ReactDOMServer.renderToStaticMarkup(React.createElement(ContextWrapper));\r\n        }\r\n        return ReactDOMServer.renderToStaticMarkup(el);\r\n      },\r\n    };\r\n  }\r\n\r\n  // Provided a bag of options, return an `EnzymeRenderer`. Some options can be implementation\r\n  // specific, like `attach` etc. for React, but not part of this interface explicitly.\r\n  // eslint-disable-next-line class-methods-use-this\r\n  createRenderer(options) {\r\n    switch (options.mode) {\r\n      case EnzymeAdapter.MODES.MOUNT: return this.createMountRenderer(options);\r\n      case EnzymeAdapter.MODES.SHALLOW: return this.createShallowRenderer(options);\r\n      case EnzymeAdapter.MODES.STRING: return this.createStringRenderer(options);\r\n      default:\r\n        throw new Error(`Enzyme Internal Error: Unrecognized mode: ${options.mode}`);\r\n    }\r\n  }\r\n\r\n  wrap(element) {\r\n    return wrap(element);\r\n  }\r\n\r\n  // converts an RSTNode to the corresponding JSX Pragma Element. This will be needed\r\n  // in order to implement the `Wrapper.mount()` and `Wrapper.shallow()` methods, but should\r\n  // be pretty straightforward for people to implement.\r\n  // eslint-disable-next-line class-methods-use-this\r\n  nodeToElement(node) {\r\n    if (!node || typeof node !== 'object') return null;\r\n    const { type } = node;\r\n    return React.createElement(unmemoType(type), propsWithKeysAndRef(node));\r\n  }\r\n\r\n  // eslint-disable-next-line class-methods-use-this\r\n  matchesElementType(node, matchingType) {\r\n    if (!node) {\r\n      return node;\r\n    }\r\n    const { type } = node;\r\n    return unmemoType(type) === unmemoType(matchingType);\r\n  }\r\n\r\n  elementToNode(element) {\r\n    return elementToTree(element);\r\n  }\r\n\r\n  nodeToHostNode(node, supportsArray = false) {\r\n    const nodes = nodeToHostNode(node);\r\n    if (Array.isArray(nodes) && !supportsArray) {\r\n      return nodes[0];\r\n    }\r\n    return nodes;\r\n  }\r\n\r\n  displayNameOfNode(node) {\r\n    if (!node) return null;\r\n    const { type, $$typeof } = node;\r\n\r\n    const nodeType = type || $$typeof;\r\n\r\n    // newer node types may be undefined, so only test if the nodeType exists\r\n    if (nodeType) {\r\n      switch (nodeType) {\r\n        case ConcurrentMode || NaN: return 'ConcurrentMode';\r\n        case Fragment || NaN: return 'Fragment';\r\n        case StrictMode || NaN: return 'StrictMode';\r\n        case Profiler || NaN: return 'Profiler';\r\n        case Portal || NaN: return 'Portal';\r\n        case Suspense || NaN: return 'Suspense';\r\n        default:\r\n      }\r\n    }\r\n\r\n    const $$typeofType = type && type.$$typeof;\r\n\r\n    switch ($$typeofType) {\r\n      case ContextConsumer || NaN: return 'ContextConsumer';\r\n      case ContextProvider || NaN: return 'ContextProvider';\r\n      case Memo || NaN: {\r\n        const nodeName = displayNameOfNode(node);\r\n        return typeof nodeName === 'string' ? nodeName : `Memo(${displayNameOfNode(type)})`;\r\n      }\r\n      case ForwardRef || NaN: {\r\n        if (type.displayName) {\r\n          return type.displayName;\r\n        }\r\n        const name = displayNameOfNode({ type: type.render });\r\n        return name ? `ForwardRef(${name})` : 'ForwardRef';\r\n      }\r\n      case Lazy || NaN: {\r\n        return 'lazy';\r\n      }\r\n      default: return displayNameOfNode(node);\r\n    }\r\n  }\r\n\r\n  isValidElement(element) {\r\n    return isElement(element);\r\n  }\r\n\r\n  isValidElementType(object) {\r\n    return !!object && isValidElementType(object);\r\n  }\r\n\r\n  isFragment(fragment) {\r\n    return typeOfNode(fragment) === Fragment;\r\n  }\r\n\r\n  isCustomComponent(type) {\r\n    const fakeElement = makeFakeElement(type);\r\n    return !!type && (\r\n      typeof type === 'function'\r\n      || isForwardRef(fakeElement)\r\n      || isContextProvider(fakeElement)\r\n      || isContextConsumer(fakeElement)\r\n      || isSuspense(fakeElement)\r\n    );\r\n  }\r\n\r\n  isContextConsumer(type) {\r\n    return !!type && isContextConsumer(makeFakeElement(type));\r\n  }\r\n\r\n  isCustomComponentElement(inst) {\r\n    if (!inst || !this.isValidElement(inst)) {\r\n      return false;\r\n    }\r\n    return this.isCustomComponent(inst.type);\r\n  }\r\n\r\n  getProviderFromConsumer(Consumer) {\r\n    // React stores references to the Provider on a Consumer differently across versions.\r\n    if (Consumer) {\r\n      let Provider;\r\n      if (Consumer._context) { // check this first, to avoid a deprecation warning\r\n        ({ Provider } = Consumer._context);\r\n      } else if (Consumer.Provider) {\r\n        ({ Provider } = Consumer);\r\n      }\r\n      if (Provider) {\r\n        return Provider;\r\n      }\r\n    }\r\n    throw new Error('Enzyme Internal Error: can’t figure out how to get Provider from Consumer');\r\n  }\r\n\r\n  createElement(...args) {\r\n    return React.createElement(...args);\r\n  }\r\n\r\n  wrapWithWrappingComponent(node, options) {\r\n    return {\r\n      RootFinder,\r\n      node: wrapWithWrappingComponent(React.createElement, node, options),\r\n    };\r\n  }\r\n}\r\n\r\nmodule.exports = ReactEighteenAdapter;\r\n"],"mappings":"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"}